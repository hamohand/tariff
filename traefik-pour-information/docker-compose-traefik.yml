services:
   traefik:
     image: traefik:v2.10
     container_name: traefik
     command:
       - "--log.level=DEBUG"
       - "--api.insecure=true"
       - "--providers.docker=true"
       - "--providers.docker.exposedbydefault=false"
       # --- Points d'entr√©e ---
       - "--entrypoints.web.address=:80"
       - "--entrypoints.websecure.address=:443"
       # --- Configuration ACME comme dans leur exemple ---
       - "--certificatesresolvers.myresolver.acme.email=hamohand@gmail.com"
       - "--certificatesresolvers.myresolver.acme.storage=/letsencrypt/acme.json"
       - "--certificatesresolvers.myresolver.acme.tlschallenge=true"
     labels:
       - "traefik.enable=true"
       - "traefik.http.middlewares.https-redirect.redirectscheme.scheme=https"
       - "traefik.http.middlewares.https-redirect.redirectscheme.permanent=true"
     ports:
       - "80:80"
       - "443:443"
       - "8080:8080"
     volumes:
       - /var/run/docker.sock:/var/run/docker.sock:ro
       - traefik-letsencrypt:/letsencrypt
     networks:
       - webproxy
volumes:
   traefik-letsencrypt:
networks:
  webproxy:
    external: true